body { background: #191919; color: #e6e6e6; }
html { margin:0; padding:0; height:100%; font-family:sans-serif; }
#main { display:flex; height:calc(100vh - 100px); }
#headline { padding: 5px; background: #222; }
#controls { padding: 5px; background: #222; }
#nodeControls { padding: 5px; background: #222; }

.inline-div {
  display: inline-block;
  text-align: center
}

:root {
  --image-brightness: 1;
}
#drawflow {
  position: relative;
  flex: 3;
  height: 700px;
  background-color: #000;
  overflow: hidden;
  z-index: 1;
}

/* BOTTOM LINE (optional, keep if you use it elsewhere) */
#drawflow-bottomline {
  position: absolute;
  left: 0; right: 0;
  height: 1px;
  background: #b9f8b9;
  pointer-events: none;
  z-index: 2;
}

/* Editor panel */
#editor { flex: 1; min-width: 340px; padding: 18px 16px 16px 16px; background: #181818; }
#nodeEditor label { margin-top: 6px; margin-right: 6px; display:inline-block; }
#nodeEditor input, #nodeEditor select { margin-bottom: 7px; margin-right:8px;}
#wsLogBox {
  resize: vertical;
  min-height: 50px;
  max-height: 300px;
  height: 120px;
}
.log-info { color: #2d862d; }
.log-error { color: #c0392b; }

select { padding:6px; font-size:14px; border-radius:4px; border:1px solid #ccc; }

button {
  background: #169c00; color: #f3f3f3;
  border: none; padding: 6px 14px; border-radius: 7px;
  margin-right: 4px; margin-bottom: 8px; cursor:pointer;
}
button:active { background: #2d862d; color: white; }
button:hover { background: #02c258; }

.logic-node {
  min-width: 65px !important;
  max-width: 65px !important;
  width: 65px !important;
  min-height: 32px !important;
  max-height: 32px !important;
  height: 32px !important;
  font-size: 13px !important;
  padding: 2px 0px !important;
  text-align: center !important;
  display: flex;
  align-items: center;
  justify-content: center;
  margin: 0 auto !important;
}
.current-value {
  font-size: 12px;
  font-weight: 500;
  margin-top: 2px;
  padding: 2px 8px;
  border-radius: 6px;
  display: inline-block;
}
.main-path.highlighted {
  stroke: limegreen !important;
  stroke-width: 10px !important;
}
.drawflow-node.executed {
  outline: 5px solid limegreen !important;
  box-shadow: 0 0 0 3px #212c34, 0 0 0 0 transparent !important;
  border-radius: 14px !important;
  z-index: 2000 !important;
  animation: none !important;
  filter: none !important;
}
#sendFlow.need-save {
  background: #e6462d !important;
  color: #fff !important;
  border: 2px solid #900 !important;
  font-weight: bold;
  box-shadow: 0 0 8px #e6462d77;
}
.cv-on    { color: #0c0; }
.cv-off   { color: #e34c4c; }
.cv-num   { color: #3af; }
.cv-other { color: #eec150; }

.drawflow-node {
  border-radius: 18px !important;
  box-shadow: 0 2px 14px 0 #00000022;
  overflow: hidden;
  border: 1.5px solid #29475e;
  background: #232a2d !important;
  opacity: 1 !important;
}
.drawflow-node .drawflow-content {
  border-radius: 0 0 16px 16px;
  padding: 9px 8px;
}
#exportVarsBtn.need-export {
  background: #e6462d !important;
  color: #fff !important;
  border: 2px solid #900 !important;
  font-weight: bold;
  box-shadow: 0 0 8px #e6462d77;
}

.drawflow-node .outputs .output { width: 14px; height: 14px; }
.drawflow-node .outputs .output[data-name="false"] { background: #e67e22; }
.drawflow-node .outputs .output[data-name="true"] { background: #27ae60; }

.drawflow .drawflow-node {
  background: #5d2ef8 !important;
  border: 2.2px solid #0cb56d !important;
  color: #000 !important;
  opacity: 1 !important;
}
.drawflow .drawflow-node.selected {
  border: 3px solid #02f84c !important;
  box-shadow: 0 0 8px 2px #02f84c80 !important;
}

.drawflow-node.eventTrigger {
  background: #fb0101 !important;
  border: 2.2px solid #0cb56d !important;
  color: #000 !important;
  opacity: 1 !important;
}
.drawflow-node.condition {
  background: #fc9331 !important;
  border: 2.2px solid #0cb56d !important;
  color: #000 !important;
  opacity: 1 !important;
}
.drawflow-node.device {
  background: #68f389 !important;
  border: 2.2px solid #0cb56d !important;
  color: #000 !important;
  opacity: 1 !important;
}
.drawflow-node.setVariable {
  background: #f7026c !important;
  border: 2.2px solid #0cb56d !important;
  color: #000 !important;
  opacity: 1 !important;
}
.drawflow-node.notification {
  background: #01a8fb !important;
  border: 2.2px solid #0cb56d !important;
  color: #000 !important;
  opacity: 1 !important;
}
.drawflow-node.comment {
  background: #faf777 !important;
  border: 2.2px solid #0cb56d !important;
  color: #000 !important;
  min-width: 300px !important;
  border-radius: 0 !important;
  opacity: 1 !important;
}
.drawflow-node.and,
.drawflow-node.or,
.drawflow-node.not {
  background: #ab02f9 !important;
  border: 2.2px solid #0cb56d !important;
  color: #000 !important;
  opacity: 1 !important;
}
.drawflow-node.schedule {
  background: #fb0101 !important;
  border: 2.2px solid #0cb56d !important;
  color: #000 !important;
  opacity: 1 !important;
}
.drawflow-node.selected-multi {
  outline: 5px solid #00fff7 !important;
  box-shadow: 0 0 0 3px #212c34, 0 0 0 0 transparent !important;
  border-radius: 14px !important;
  z-index: 2000 !important;
  animation: none !important;
  filter: none !important;
}

#df-ctx-menu {
  animation: fadeinCtx .16s;
  box-shadow: 0 8px 32px #000b !important;
}
#df-ctx-menu div {
  border-radius: 7px;
}
#df-ctx-menu div:active {
  filter: brightness(1.12);
  background: #3e62ed !important;
}
@keyframes fadeinCtx {
  from { opacity: 0; transform: scale(.97);}
  to { opacity: 1; transform: scale(1);}
}

.drawflow-node.replay-path {
  box-shadow: 0 0 0 4px #ffe46b, 0 2px 10px #000b !important;
  border-color: #ffe46b !important;
}
.drawflow-node.flow-path {
  box-shadow: 0 0 0 4px #f0e130, 0 2px 10px #000b !important;
  border-color: #ffe46b !important;
}

/* --- IMAGE BACKGROUND (dimmable, pointer-events none) --- */
#drawflow-bg-image {
  position: absolute;
  top: 0; left: 0; width: 100%; height: 100%;
  object-fit: cover;
  z-index: 0;
  pointer-events: none;
  opacity: var(--image-brightness, 1);
  display: none;
  transition: opacity 0.2s;
}
#drawflow.image-bg #drawflow-bg-image {
  display: block;
}

/* --- Ensure Drawflow input/output dots show up --- */
.drawflow .drawflow-node .inputs,
.drawflow .drawflow-node .outputs {
  width: 20px !important;
  min-width: 20px !important;
  display: flex;
  flex-direction: column;
  align-items: center;
  position: relative;
  z-index: 3;
}
.drawflow .drawflow-node .input,
.drawflow .drawflow-node .output {
  width: 16px !important;
  height: 16px !important;
  border-radius: 50%;
  border: 2px solid #000 !important;
  margin: 10px 0 10px 0 !important;
  cursor: crosshair;
  box-shadow: 0 1px 4px #0005;
  background: #fc9d2e !important;
}
.drawflow .drawflow-node .input {
  background: #90cdf4 !important;
  left: -20px !important;
  position: relative;
}
.drawflow .drawflow-node .output {
  background: #fc9d2e !important;
  right: -20px !important;
  position: relative;
}
.drawflow .drawflow-node .outputs .output:first-child {
  background: #27ae60 !important;
}
.drawflow .drawflow-node .outputs .output:last-child {
  background: #e6462d !important;
}
.drawflow .drawflow-node .outputs .output:first-child:last-child {
  background: #27ae60 !important;
}

/* Solid tile patch */
.drawflow-node .drawflow_content_node,
.drawflow-node .drawflow-content,
.drawflow-node > div,
.drawflow-node .device-tile,
.drawflow-node .condition-tile,
.drawflow-node .trigger-tile,
.drawflow-node .setVariable-tile,
.drawflow-node .notification-tile,
.drawflow-node .schedule-tile,
.drawflow-node .comment-tile,
.drawflow-node .logic-node {
    background: inherit !important;
    opacity: 1 !important;
}

/* --- No old grid lines or overlays --- */
#drawflow::before { display: none !important; }
#drawflow-grid-overlay { display: none !important; }

/* --- Ensure #drawflow itself NEVER gets opacity or background-image --- */
#drawflow,
#drawflow.image-bg {
  opacity: 1 !important;
  background-image: none !important;
}
